<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-07-24 Mon 16:42 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs Org-mode: Use good header ids!</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Lee Hinman" />
<link rel="stylesheet" href="../css/tufte.css" type="text/css" />
<link rel="stylesheet" href="../css/tufte.css" type="text/css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Emacs Org-mode: Use good header ids!</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="emacs-org-mode-generate-ids.html#header-intro">Introduction</a></li>
<li><a href="emacs-org-mode-generate-ids.html#the-problem">The Problem - anchors are not consistent</a></li>
<li><a href="emacs-org-mode-generate-ids.html#the-solution">The Solution - use custom ids in headline properties</a></li>
<li><a href="emacs-org-mode-generate-ids.html#automating-id-creation">Automating adding the CUSTOM_ID</a></li>
<li><a href="emacs-org-mode-generate-ids.html#update-2016-09-07">Update 2016-09-07</a></li>
<li><a href="emacs-org-mode-generate-ids.html#h-cf29e5e7-b456-4842-a3f7-e9185897ac3b">Update 2017-07-24</a></li>
</ul>
</div>
</div>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Author</b></td>
<td class="org-left">Lee Hinman (lee@writequit.org)</td>
</tr>

<tr>
<td class="org-left"><b>Date</b></td>
<td class="org-left">2017-07-24 16:42:01</td>
</tr>
</tbody>
</table>

<div id="outline-container-org3980e17" class="outline-2">
<h2 id="header-intro"><a id="org3980e17"></a>Introduction</h2>
<div class="outline-text-2" id="text-header-intro">
<p>
I frequently write many articles in org-mode, some private, some public. <a href="http://writequit.org">Most</a> <a href="http://writequit.org/org/es/">of</a>
<a href="http://writequit.org/articles/getting-started-with-git-annex.html">the</a> <a href="http://writequit.org/articles/literate-es-scripts.html">public</a> <a href="http://writequit.org/denver-emacs/">ones</a> eventually end up published on my site as HTML documents, to be
shared with co-workers or anyone who happens to be browsing my site. Recently,
however, I've noticed that many org documents that are exported to HTML are
using a concerning method of anchoring links to different headlines.
</p>
</div>
</div>

<div id="outline-container-orgdfc1c09" class="outline-2">
<h2 id="the-problem"><a id="orgdfc1c09"></a>The Problem - anchors are not consistent</h2>
<div class="outline-text-2" id="text-the-problem">
<p>
Let's take an <code>example.org</code> document, the simplest example of a an org-mode
buffer with just a few headlines:
</p>

<pre class="code"><code><span style="color: #0066BB; font-weight: bold;">* Headline 1</span>
This is some text

<span style="color: #0066BB; font-weight: bold;">* Headline 2</span>
This is heading number two

<span style="color: #f9f9f9;">*</span><span style="color: #996633; font-weight: bold;">* Sub heading 1</span>

<span style="color: #f9f9f9;">*</span><span style="color: #996633; font-weight: bold;">* Sub heading 2</span>

<span style="color: #0066BB; font-weight: bold;">* Headline 3</span>
In conclusion, this is an example
</code></pre>

<p>
Now, if you invoke <code>C-c C-e</code> to bring up the export options and export this
document to HTML, you'll end up with a document that looks something like this:
</p>


<div class="figure">
<p><img src="images/org-export1.png" alt="org-export1.png" />
</p>
</div>

<p>
Currently this is at the <code>file:///home/hinmanm/example.html</code> url. In the table
of contents, if you click on the <code>Headline 2</code> heading, you are then taken to the
<code>file:///home/hinmanm/example.html#sec-2</code> and jump to that location on the page
(imagine the page is longer so you would jump to the location).
</p>

<p>
The issue with this is when we edit our <code>example.org</code> file to add a headline
somewhere in the middle, in this case, adding a "Newly added headline" in
between "Headline 1" and "Headline 2".
</p>

<pre class="code"><code><span style="color: #0066BB; font-weight: bold;">* Headline 1</span>
This is some text

<span style="color: #0066BB; font-weight: bold;">* Newly added headline</span>
Wait, I've decided that this information is really important!

<span style="color: #0066BB; font-weight: bold;">* Headline 2</span>
This is heading number two

<span style="color: #f9f9f9;">*</span><span style="color: #996633; font-weight: bold;">* Sub heading 1</span>

<span style="color: #f9f9f9;">*</span><span style="color: #996633; font-weight: bold;">* Sub heading 2</span>

<span style="color: #0066BB; font-weight: bold;">* Headline 3</span>
In conclusion, this is an example
</code></pre>

<p>
If this is again exported to HTML, we get:
</p>


<div class="figure">
<p><img src="images/org-export2.png" alt="org-export2.png" />
</p>
</div>

<p>
But wait! Notice that the previously visited HTML anchor <code>#sec-2</code> now points to
the "Newly added headline" headline, instead of "Headline 2" like it used to!
This is a problem for any public HTML document where someone may keep a link to
a sub heading, or send the heading to another person. As the number of headlines
increases, the chance of inserting a headline and messing up the anchors
increases. So, how can you handle this?
</p>
</div>
</div>

<div id="outline-container-org2ce7f6c" class="outline-2">
<h2 id="the-solution"><a id="org2ce7f6c"></a>The Solution - use custom ids in headline properties</h2>
<div class="outline-text-2" id="text-the-solution">
<p>
Org-mode has property drawers for properties that apply to headlines, and we can
assign a custom ID to a headline by setting the <code>CUSTOM_ID</code> property, so if we
do that to the "Headline 2" heading, you can see:
</p>

<pre class="code"><code><span style="color: #0066BB; font-weight: bold;">* Headline 1</span>
This is some text

<span style="color: #0066BB; font-weight: bold;">* Newly added headline</span>
Wait, I've decided that this information is really important!

<span style="color: #0066BB; font-weight: bold;">* Headline 2</span>
<span style="color: #90a4be;">:PROPERTIES:</span>
<span style="color: #90a4be;">:CUSTOM_ID:</span> my-headline-2
<span style="color: #90a4be;">:END:</span>
This is heading number two

<span style="color: #f9f9f9;">*</span><span style="color: #996633; font-weight: bold;">* Sub heading 1</span>

<span style="color: #f9f9f9;">*</span><span style="color: #996633; font-weight: bold;">* Sub heading 2</span>

<span style="color: #0066BB; font-weight: bold;">* Headline 3</span>
In conclusion, this is an example
</code></pre>

<p>
When this org document is exported to HTML, instead of using <code>#sec-2</code> as the
anchor, the value of the <code>CUSTOM_ID</code> will be used instead. This means the full
link will be <code>file:///home/hinmanm/example.html#my-headline-2</code>, no matter how
many headings you insert before or after the heading. You can also give the
anchor a much more human-friendly name instead of a section number.
</p>
</div>
</div>

<div id="outline-container-org7321176" class="outline-2">
<h2 id="automating-id-creation"><a id="org7321176"></a>Automating adding the CUSTOM_ID</h2>
<div class="outline-text-2" id="text-automating-id-creation">
<p>
Fantastic! You may say, the only issue is that now I have to go through and
manually add these custom ids! Well, fear not, because there is some elisp that
can do this easily for you:
</p>

<p>
First, you'll need to require the <code>org-id</code> library, which has some helpers for
this. You may also want to use your <code>CUSTOM_ID</code> for links also:
</p>

<pre class="code"><code><span style="color: #7f7f7f;">(</span><span style="color: #008800;">require</span> <span style="color: #008800;">'</span><span style="color: #003366;">org-id</span><span style="color: #7f7f7f;">)</span>
<span style="color: #7f7f7f;">(</span><span style="color: #008800;">setq</span> org-id-link-to-org-use-id <span style="color: #008800;">'</span><span style="color: #003366;">create-if-interactive-and-no-custom-id</span><span style="color: #7f7f7f;">)</span>
</code></pre>

<p>
Then we can define our own version of <code>org-custom-id-get</code> that calls
<code>org-id-new</code> and creates a new property if one doesn't already exist<label for="1" class="margin-toggle sidenote-number"></label><input type="checkbox" id="1" class="margin-toggle"/><span class="sidenote">
In case you were wondering what the "h" is for, the ids that <code>org-id-new</code>
generates by default are actually invalid XHTML anchors (because they start with
a number instead of a character), so this changes them to start with "h".
</span>.
</p>

<pre class="code"><code><span style="color: #7f7f7f;">(</span><span style="color: #008800;">defun</span> <span style="color: #0066BB;">eos/org-custom-id-get</span> <span style="color: #7f7f7f;">(</span><span style="color: #333399;">&amp;optional</span> pom create prefix<span style="color: #7f7f7f;">)</span>
  <span style="color: #206070;">"Get the CUSTOM_ID property of the entry at point-or-marker POM.</span>
<span style="color: #206070;">   If POM is nil, refer to the entry at point. If the entry does</span>
<span style="color: #206070;">   not have an CUSTOM_ID, the function returns nil. However, when</span>
<span style="color: #206070;">   CREATE is non nil, create a CUSTOM_ID if none is present</span>
<span style="color: #206070;">   already. PREFIX will be passed through to `</span><span style="color: #003366;">org-id-new</span><span style="color: #206070;">'. In any</span>
<span style="color: #206070;">   case, the CUSTOM_ID of the entry is returned."</span>
  <span style="color: #7f7f7f;">(</span><span style="color: #008800;">interactive</span><span style="color: #7f7f7f;">)</span>
  <span style="color: #7f7f7f;">(</span><span style="color: #008800;">org-with-point-at</span> pom
    <span style="color: #7f7f7f;">(</span><span style="color: #008800;">let</span> <span style="color: #7f7f7f;">((</span>id <span style="color: #7f7f7f;">(</span>org-entry-get nil <span style="background-color: #fff0f0;">"CUSTOM_ID"</span><span style="color: #7f7f7f;">)))</span>
      <span style="color: #7f7f7f;">(</span><span style="color: #008800;">cond</span>
       <span style="color: #7f7f7f;">((</span><span style="color: #008800;">and</span> id <span style="color: #7f7f7f;">(</span>stringp id<span style="color: #7f7f7f;">)</span> <span style="color: #7f7f7f;">(</span>string-match <span style="background-color: #fff0f0;">"</span><span style="color: #000000; background-color: #fff0f0; font-weight: bold;">\</span><span style="color: #000000; background-color: #fff0f0; font-weight: bold;">\</span><span style="background-color: #fff0f0;">S-"</span> id<span style="color: #7f7f7f;">))</span>
        id<span style="color: #7f7f7f;">)</span>
       <span style="color: #7f7f7f;">(</span>create
        <span style="color: #7f7f7f;">(</span><span style="color: #008800;">setq</span> id <span style="color: #7f7f7f;">(</span>org-id-new <span style="color: #7f7f7f;">(</span>concat prefix <span style="background-color: #fff0f0;">"h"</span><span style="color: #7f7f7f;">)))</span>
        <span style="color: #7f7f7f;">(</span>org-entry-put pom <span style="background-color: #fff0f0;">"CUSTOM_ID"</span> id<span style="color: #7f7f7f;">)</span>
        <span style="color: #7f7f7f;">(</span>org-id-add-location id <span style="color: #7f7f7f;">(</span>buffer-file-name <span style="color: #7f7f7f;">(</span>buffer-base-buffer<span style="color: #7f7f7f;">)))</span>
        id<span style="color: #7f7f7f;">)))))</span>
</code></pre>

<p>
And add a helper function that's interactive to add custom ids to <b>all</b>
headlines in the buffer if they don't already have one.
</p>

<pre class="code"><code><span style="color: #7f7f7f;">(</span><span style="color: #008800;">defun</span> <span style="color: #0066BB;">eos/org-add-ids-to-headlines-in-file</span> <span style="color: #7f7f7f;">()</span>
  <span style="color: #206070;">"Add CUSTOM_ID properties to all headlines in the</span>
<span style="color: #206070;">   current file which do not already have one."</span>
  <span style="color: #7f7f7f;">(</span><span style="color: #008800;">interactive</span><span style="color: #7f7f7f;">)</span>
  <span style="color: #7f7f7f;">(</span>org-map-entries <span style="color: #7f7f7f;">(</span><span style="color: #008800;">lambda</span> <span style="color: #7f7f7f;">()</span> <span style="color: #7f7f7f;">(</span>eos/org-custom-id-get <span style="color: #7f7f7f;">(</span>point<span style="color: #7f7f7f;">)</span> <span style="color: #008800;">'</span><span style="color: #003366;">create</span><span style="color: #7f7f7f;">))))</span>
</code></pre>

<p>
Now to add headlines, you can hit <code>M-x eos/org-add-ids-to-headlines-in-file</code> and
you'll get something like this!
</p>

<pre class="code"><code><span style="color: #0066BB; font-weight: bold;">* Headline 1</span>
<span style="color: #90a4be;">:PROPERTIES:</span>
<span style="color: #90a4be;">:CUSTOM_ID:</span> h:7d66adcc-5e24-4f49-9923-4816bc30a7cb
<span style="color: #90a4be;">:END:</span>
This is some text

<span style="color: #0066BB; font-weight: bold;">* Newly added headline</span>
<span style="color: #90a4be;">:PROPERTIES:</span>
<span style="color: #90a4be;">:CUSTOM_ID:</span> h:7c38f8ef-0c8c-4f17-a7da-7ed7d5eedeff
<span style="color: #90a4be;">:END:</span>
Wait, I've decided that this information is really important!

<span style="color: #0066BB; font-weight: bold;">* Headline 2</span>
<span style="color: #90a4be;">:PROPERTIES:</span>
<span style="color: #90a4be;">:CUSTOM_ID:</span> my-headline-2
<span style="color: #90a4be;">:END:</span>
This is heading number two

<span style="color: #f9f9f9;">*</span><span style="color: #996633; font-weight: bold;">* Sub heading 1</span>
<span style="color: #90a4be;">:PROPERTIES:</span>
<span style="color: #90a4be;">:CUSTOM_ID:</span> h:2c29be2d-be83-46d3-bee8-bcbe75e4160b
<span style="color: #90a4be;">:END:</span>

<span style="color: #f9f9f9;">*</span><span style="color: #996633; font-weight: bold;">* Sub heading 2</span>
<span style="color: #90a4be;">:PROPERTIES:</span>
<span style="color: #90a4be;">:CUSTOM_ID:</span> h:e148d5ed-8e55-4e26-bd5a-c414ed06fa5a
<span style="color: #90a4be;">:END:</span>

<span style="color: #0066BB; font-weight: bold;">* Headline 3</span>
<span style="color: #90a4be;">:PROPERTIES:</span>
<span style="color: #90a4be;">:CUSTOM_ID:</span> h:a1b44d60-488a-4aae-8ae4-6b98d5dbef7e
<span style="color: #90a4be;">:END:</span>
In conclusion, this is an example
</code></pre>

<p>
(It looks better when the <code>:PROPERTIES:</code> drawers are collapsed of course). If
you decide you want to add a nicer-looking CUSTOM_ID instead of the UUID, you
can hit <code>C-c C-x p</code> and be prompted to change the property.
</p>

<p>
Finally, if you so desire, here is an optional helper if you want to add a
<code>CUSTOM_ID</code> to headlines created when you use an org-capture template:
</p>

<pre class="code"><code><span style="color: #888888;">;; </span><span style="color: #888888;">automatically add ids to captured headlines</span>
<span style="color: #7f7f7f;">(</span>add-hook <span style="color: #008800;">'</span><span style="color: #003366;">org-capture-prepare-finalize-hook</span>
          <span style="color: #7f7f7f;">(</span><span style="color: #008800;">lambda</span> <span style="color: #7f7f7f;">()</span> <span style="color: #7f7f7f;">(</span>eos/org-custom-id-get <span style="color: #7f7f7f;">(</span>point<span style="color: #7f7f7f;">)</span> <span style="color: #008800;">'</span><span style="color: #003366;">create</span><span style="color: #7f7f7f;">)))</span>
</code></pre>

<p>
Now go forth and make anchor links that don't break!
</p>
</div>
</div>
<div id="outline-container-orga56defc" class="outline-2">
<h2 id="update-2016-09-07"><a id="orga56defc"></a>Update 2016-09-07</h2>
<div class="outline-text-2" id="text-update-2016-09-07">
<p>
I've updated the <code>eos/org-add-ids-to-headlines-in-file</code> method to check for the
string <code>#+OPTIONS: auto-id:t</code> in the file somewhere (usually at the top) and
automatically add ids when the file is saved. The new version looks like:
</p>

<pre class="code"><code><span style="color: #7f7f7f;">(</span><span style="color: #008800;">defun</span> <span style="color: #0066BB;">eos/org-add-ids-to-headlines-in-file</span> <span style="color: #7f7f7f;">()</span>
  <span style="color: #206070;">"Add CUSTOM_ID properties to all headlines in the current</span>
<span style="color: #206070;">   file which do not already have one. Only adds ids if the</span>
<span style="color: #206070;">   `</span><span style="color: #003366;">auto-id</span><span style="color: #206070;">' option is set to `t' in the file somewhere. ie,</span>
<span style="color: #206070;">   #+OPTIONS: auto-id:t"</span>
  <span style="color: #7f7f7f;">(</span><span style="color: #008800;">interactive</span><span style="color: #7f7f7f;">)</span>
  <span style="color: #7f7f7f;">(</span><span style="color: #008800;">save-excursion</span>
    <span style="color: #7f7f7f;">(</span>widen<span style="color: #7f7f7f;">)</span>
    <span style="color: #7f7f7f;">(</span>goto-char <span style="color: #7f7f7f;">(</span>point-min<span style="color: #7f7f7f;">))</span>
    <span style="color: #7f7f7f;">(</span><span style="color: #008800;">when</span> <span style="color: #7f7f7f;">(</span>re-search-forward <span style="background-color: #fff0f0;">"^#</span><span style="color: #000000; background-color: #fff0f0; font-weight: bold;">\</span><span style="color: #000000; background-color: #fff0f0; font-weight: bold;">\</span><span style="background-color: #fff0f0;">+OPTIONS:.*auto-id:t"</span> <span style="color: #7f7f7f;">(</span>point-max<span style="color: #7f7f7f;">)</span> t<span style="color: #7f7f7f;">)</span>
      <span style="color: #7f7f7f;">(</span>org-map-entries <span style="color: #7f7f7f;">(</span><span style="color: #008800;">lambda</span> <span style="color: #7f7f7f;">()</span> <span style="color: #7f7f7f;">(</span>eos/org-custom-id-get <span style="color: #7f7f7f;">(</span>point<span style="color: #7f7f7f;">)</span> <span style="color: #008800;">'</span><span style="color: #003366;">create</span><span style="color: #7f7f7f;">))))))</span>
</code></pre>

<p>
And then it's automatically<label for="2" class="margin-toggle sidenote-number"></label><input type="checkbox" id="2" class="margin-toggle"/><span class="sidenote">Running it automatically is up to you, I find
it easy to leave the hook in and add the option when I am intending to publish
the HTML publicly somewhere</span> run with:
</p>

<pre class="code"><code><span style="color: #888888;">;; </span><span style="color: #888888;">automatically add ids to saved org-mode headlines</span>
<span style="color: #7f7f7f;">(</span>add-hook <span style="color: #008800;">'</span><span style="color: #003366;">org-mode-hook</span>
          <span style="color: #7f7f7f;">(</span><span style="color: #008800;">lambda</span> <span style="color: #7f7f7f;">()</span>
            <span style="color: #7f7f7f;">(</span>add-hook <span style="color: #008800;">'</span><span style="color: #003366;">before-save-hook</span>
                      <span style="color: #7f7f7f;">(</span><span style="color: #008800;">lambda</span> <span style="color: #7f7f7f;">()</span>
                        <span style="color: #7f7f7f;">(</span><span style="color: #008800;">when</span> <span style="color: #7f7f7f;">(</span><span style="color: #008800;">and</span> <span style="color: #7f7f7f;">(</span>eq major-mode <span style="color: #008800;">'</span><span style="color: #003366;">org-mode</span><span style="color: #7f7f7f;">)</span>
                                   <span style="color: #7f7f7f;">(</span>eq buffer-read-only nil<span style="color: #7f7f7f;">))</span>
                          <span style="color: #7f7f7f;">(</span>eos/org-add-ids-to-headlines-in-file<span style="color: #7f7f7f;">))))))</span>
</code></pre>
</div>
</div>

<div id="outline-container-orgf72fa3d" class="outline-2">
<h2 id="h-cf29e5e7-b456-4842-a3f7-e9185897ac3b"><a id="orgf72fa3d"></a>Update 2017-07-24</h2>
<div class="outline-text-2" id="text-h-cf29e5e7-b456-4842-a3f7-e9185897ac3b">
<p>
I got a nice email from a fellow who mentioned that an id like <code>h:1234</code> breaks jquery trying to
select that particular heading. So in order to fix that, do the following:
</p>

<pre class="code"><code><span style="color: #7f7f7f;">(</span><span style="color: #008800;">defun</span> <span style="color: #0066BB;">org-id-new</span> <span style="color: #7f7f7f;">(</span><span style="color: #333399;">&amp;optional</span> prefix<span style="color: #7f7f7f;">)</span>
  <span style="color: #206070;">"Create a new globally unique ID.</span>

<span style="color: #206070;">An ID consists of two parts separated by a colon:</span>
<span style="color: #206070;">- a prefix</span>
<span style="color: #206070;">- a unique part that will be created according to `</span><span style="color: #003366;">org-id-method</span><span style="color: #206070;">'.</span>

<span style="color: #206070;">PREFIX can specify the prefix, the default is given by the variable</span>
<span style="color: #206070;">`</span><span style="color: #003366;">org-id-prefix</span><span style="color: #206070;">'.  However, if PREFIX is the symbol `</span><span style="color: #003366;">none</span><span style="color: #206070;">', don't use any</span>
<span style="color: #206070;">prefix even if `</span><span style="color: #003366;">org-id-prefix</span><span style="color: #206070;">' specifies one.</span>

<span style="color: #206070;">So a typical ID could look like </span><span style="color: #000000; font-weight: bold;">\</span><span style="color: #000000; font-weight: bold;">"</span><span style="color: #206070;">Org-4nd91V40HI</span><span style="color: #000000; font-weight: bold;">\</span><span style="color: #000000; font-weight: bold;">"</span><span style="color: #206070;">."</span>
  <span style="color: #7f7f7f;">(</span><span style="color: #008800;">let*</span> <span style="color: #7f7f7f;">((</span>prefix <span style="color: #7f7f7f;">(</span><span style="color: #008800;">if</span> <span style="color: #7f7f7f;">(</span>eq prefix <span style="color: #008800;">'</span><span style="color: #003366;">none</span><span style="color: #7f7f7f;">)</span>
                     <span style="background-color: #fff0f0;">""</span>
                   <span style="color: #7f7f7f;">(</span>concat <span style="color: #7f7f7f;">(</span><span style="color: #008800;">or</span> prefix org-id-prefix<span style="color: #7f7f7f;">)</span> <span style="background-color: #fff0f0;">"-"</span><span style="color: #7f7f7f;">)))</span>
         unique<span style="color: #7f7f7f;">)</span>
    <span style="color: #7f7f7f;">(</span><span style="color: #008800;">if</span> <span style="color: #7f7f7f;">(</span>equal prefix <span style="background-color: #fff0f0;">"-"</span><span style="color: #7f7f7f;">)</span> <span style="color: #7f7f7f;">(</span><span style="color: #008800;">setq</span> prefix <span style="background-color: #fff0f0;">""</span><span style="color: #7f7f7f;">))</span>
    <span style="color: #7f7f7f;">(</span><span style="color: #008800;">cond</span>
     <span style="color: #7f7f7f;">((</span>memq org-id-method <span style="color: #008800;">'</span><span style="color: #7f7f7f;">(</span>uuidgen uuid<span style="color: #7f7f7f;">))</span>
      <span style="color: #7f7f7f;">(</span><span style="color: #008800;">setq</span> unique <span style="color: #7f7f7f;">(</span>org-trim <span style="color: #7f7f7f;">(</span>shell-command-to-string org-id-uuid-program<span style="color: #7f7f7f;">)))</span>
      <span style="color: #7f7f7f;">(</span><span style="color: #008800;">unless</span> <span style="color: #7f7f7f;">(</span>org-uuidgen-p unique<span style="color: #7f7f7f;">)</span>
        <span style="color: #7f7f7f;">(</span><span style="color: #008800;">setq</span> unique <span style="color: #7f7f7f;">(</span>org-id-uuid<span style="color: #7f7f7f;">))))</span>
     <span style="color: #7f7f7f;">((</span>eq org-id-method <span style="color: #008800;">'</span><span style="color: #003366;">org</span><span style="color: #7f7f7f;">)</span>
      <span style="color: #7f7f7f;">(</span><span style="color: #008800;">let*</span> <span style="color: #7f7f7f;">((</span>etime <span style="color: #7f7f7f;">(</span>org-reverse-string <span style="color: #7f7f7f;">(</span>org-id-time-to-b36<span style="color: #7f7f7f;">)))</span>
             <span style="color: #7f7f7f;">(</span>postfix <span style="color: #7f7f7f;">(</span><span style="color: #008800;">if</span> org-id-include-domain
                          <span style="color: #7f7f7f;">(</span><span style="color: #008800;">progn</span>
                            <span style="color: #7f7f7f;">(</span><span style="color: #008800;">require</span> <span style="color: #008800;">'</span><span style="color: #003366;">message</span><span style="color: #7f7f7f;">)</span>
                            <span style="color: #7f7f7f;">(</span>concat <span style="background-color: #fff0f0;">"@"</span> <span style="color: #7f7f7f;">(</span>message-make-fqdn<span style="color: #7f7f7f;">))))))</span>
        <span style="color: #7f7f7f;">(</span><span style="color: #008800;">setq</span> unique <span style="color: #7f7f7f;">(</span>concat etime postfix<span style="color: #7f7f7f;">))))</span>
     <span style="color: #7f7f7f;">(</span>t <span style="color: #7f7f7f;">(</span><span style="color: #ff0000; font-weight: bold;">error</span> <span style="background-color: #fff0f0;">"Invalid `</span><span style="color: #003366; background-color: #fff0f0;">org-id-method</span><span style="background-color: #fff0f0;">'"</span><span style="color: #7f7f7f;">)))</span>
    <span style="color: #7f7f7f;">(</span>concat prefix unique<span style="color: #7f7f7f;">)))</span>
</code></pre>

<p>
This changes the header delimiter from <code>:</code> to <code>-</code> so <code>h-1234</code> is generated instead.
</p>
</div>
</div>
<!-- Footnotes --><!-- 
<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
In case you were wondering what the "h" is for, the ids that <code>org-id-new</code>
generates by default are actually invalid XHTML anchors (because they start with
a number instead of a character), so this changes them to start with "h".
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara">Running it automatically is up to you, I find
it easy to leave the hook in and add the option when I am intending to publish
the HTML publicly somewhere</div></div>

 --></div>
<div id="postamble" class="status">
<p class="author">Author: Lee Hinman</p>
<p class="date">Created: 2017-07-24 Mon 16:42</p>
<p class="validation"></p>
</div>
</body>
</html>
